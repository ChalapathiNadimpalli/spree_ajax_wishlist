<% if !spree_current_user %>
  window.location = "<%= spree.login_path %>";
<% elsif @error %>
  <% flash[:error] = @error %>
  window.location = "<%= request.referer %>";
<% elsif params['remove-wishlist-button'].present? %>
  window.location = "<%= request.referer %>";
<% elsif @active %>
  $(".wishlist-icon.product-id-<%= @product_id %>").addClass('active');
  $(".wishlist-active.product-id-<%= @product_id %>").val('false');
<% else %>
  $(".wishlist-icon.product-id-<%= @product_id %>").removeClass('active');
  $(".wishlist-active.product-id-<%= @product_id %>").val('true');
<% end %>